# This is NOT the default gitleaks config. The default gitleaks config is located
# here: https://github.com/gitleaks/gitleaks/blob/master/config/gitleaks.toml
# This gitleaks config extends the default config and ignores secrets located in the `cmd/generate/config/rules`

title = "Gitleaks development"
[extend]
useDefault = true

[allowlist]
paths = [
  '''(^|/)cmd/generate/config/rules''',
  '''.*test\.go''',
  '''testdata''',
  '''testleak\.js''',
]

[[rules]]
id = "ethereum-private-key"
description = "Detected Ethereum/EVM private key (64 hex chars)"
regex = '''(?:0x)?[a-fA-F0-9]{64}'''
entropy = 3.0
tags = ["crypto", "evm", "ethereum", "private-key"]

[[rules]]
id = "bitcoin-wif-private-key"
description = "Detected Bitcoin WIF private key"
regex = '''[5KL][1-9A-HJ-NP-Za-km-z]{50,51}'''
entropy = 3.5
tags = ["crypto", "bitcoin", "private-key"]

[[rules]]
id = "solana-private-key"
description = "Detected Solana private key (base58)"
regex = '''[1-9A-HJ-NP-Za-km-z]{87,88}'''
entropy = 4.0
tags = ["crypto", "solana", "private-key"]

[[rules]]
id = "tezos-private-key"
description = "Detected Tezos private key"
regex = '''(edsk|spsk|p2sk)[1-9A-HJ-NP-Za-km-z]{50,100}'''
entropy = 3.5
keywords = ["edsk", "spsk", "p2sk"]
tags = ["crypto", "tezos", "private-key"]

[[rules]]
id = "cardano-private-key"
description = "Detected Cardano extended private key"
regex = '''xprv[1-9A-HJ-NP-Za-km-z]{107,108}'''
entropy = 2.5
keywords = ["xprv"]
tags = ["crypto", "cardano", "private-key"]

[[rules]]
id = "ripple-xrp-private-key"
description = "Detected Ripple (XRP) secret key"
regex = '''s[1-9A-HJ-NP-Za-km-z]{28,29}'''
entropy = 3.5
tags = ["crypto", "ripple", "xrp", "private-key"]

[[rules]]
id = "stellar-private-key"
description = "Detected Stellar (XLM) secret key"
regex = '''S[A-Z2-7]{55}'''
entropy = 3.5
tags = ["crypto", "stellar", "private-key"]

[[rules]]
id = "near-private-key"
description = "Detected NEAR Protocol private key"
regex = '''ed25519:[1-9A-HJ-NP-Za-km-z]{43,44}'''
entropy = 3.0
keywords = ["ed25519"]
tags = ["crypto", "near", "private-key"]

[[rules]]
id = "algorand-private-key"
description = "Detected Algorand private key (base64)"
regex = '''[a-zA-Z0-9+/]{87}='''
entropy = 3.8
tags = ["crypto", "algorand", "private-key"]

[[rules]]
id = "generic-crypto-seed-phrase"
description = "Detected cryptocurrency seed phrase (BIP39 mnemonic)"
regex = '''(?i)\b([a-z]{3,8}\s+){11,23}[a-z]{3,8}\b'''
entropy = 2.5
keywords = ["seed", "mnemonic", "recovery", "phrase", "wallet"]
tags = ["crypto", "seed-phrase", "mnemonic"]
